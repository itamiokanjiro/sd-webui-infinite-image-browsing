import{d as ke,r as he,m as C,az as B,a1 as ve,U as u,V as S,c as n,a4 as e,a3 as o,a6 as G,W as d,L as we,Y as a,X as p,a2 as U,af as Ie,aS as _e,$ as b,ag as L,ai as Ce,T as Se,ak as N,aP as be,aQ as ye,bD as xe,a0 as Me}from"./index-9ea28d47.js";import{S as Te}from"./index-559ee174.js";import{_ as Ae}from"./index-2f7349b8.js";import{o as P,L as Ve,R as $e,f as De,M as Fe}from"./MultiSelectKeep-dbeb969c.js";import{c as Re,d as ze,F as Be}from"./FileItem-a5d8808c.js";import{c as Ge,u as Ue}from"./hook-25fc17ae.js";import"./shortcut-70212e50.js";import"./Checkbox-716ad574.js";/* empty css              */import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-1089a22e.js";import"./index-336f750c.js";import"./_isIterateeCall-c5995cdf.js";import"./useGenInfoDiff-2b0f1c22.js";const Le=c=>(be("data-v-4815fec6"),c=c(),ye(),c),Ne={class:"hint"},Pe={class:"action-bar"},Ee=Le(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Je={key:1},We={class:"no-res-hint"},Ke={class:"hint"},Oe={key:2,class:"preview-switch"},qe=ke({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},selectedTagIds:{},id:{}},setup(c){const k=c,m=he(!1),g=Ge(t=>xe({...k.selectedTagIds,random_sort:m.value},t)),{queue:E,images:s,onContextMenuClickU:y,stackViewEl:J,previewIdx:r,previewing:x,onPreviewVisibleChange:W,previewImgMove:M,canPreview:T,itemSize:A,gridItems:K,showGenInfo:f,imageGenInfo:V,q:O,multiSelectedIdxs:h,onFileItemClick:q,scroller:v,showMenuIdx:w,onFileDragStart:Q,onFileDragEnd:X,cellWidth:Y,onScroll:I,saveAllFileAsJson:j,props:H,saveLoadedFileAsJson:Z,changeIndchecked:ee,seedChangeChecked:te,getGenDiff:le,getGenDiffWatchDep:ne}=Ue(g);C(()=>k.selectedTagIds,async()=>{var t;await g.reset(),await B(),(t=v.value)==null||t.scrollToItem(0),I()},{immediate:!0}),C(m,async()=>{var t;await g.reset(),await B(),(t=v.value)==null||t.scrollToItem(0),I()}),C(()=>k,async t=>{H.value=t},{deep:!0,immediate:!0});const se=ve(),{onClearAllSelected:ie,onSelectAll:oe,onReverseSelect:ae}=Re(),de=()=>{s.value.length!==0&&P(s.value,0)};return(t,l)=>{const ce=Fe,re=Ce,ue=Se,pe=Ae,_=N,me=N,ge=Te;return u(),S("div",{class:"container",ref_key:"stackViewEl",ref:J},[n(ce,{show:!!e(h).length||e(se).keepMultiSelect,onClearAllSelected:e(ie),onSelectAll:e(oe),onReverseSelect:e(ae)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),n(ge,{size:"large",spinning:!e(E).isIdle},{default:o(()=>{var $,D,F;return[n(ue,{visible:e(f),"onUpdate:visible":l[1]||(l[1]=i=>G(f)?f.value=i:null),width:"70vw","mask-closable":"",onOk:l[2]||(l[2]=i=>f.value=!1)},{cancelText:o(()=>[]),default:o(()=>[n(re,{active:"",loading:!e(O).isIdle},{default:o(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:l[0]||(l[0]=i=>e(we)(e(V)))},[d("div",Ne,a(t.$t("doubleClickToCopy")),1),p(" "+a(e(V)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Pe,[n(pe,{checked:m.value,"onUpdate:checked":l[3]||(l[3]=i=>m.value=i),"checked-children":t.$t("randomSort"),"un-checked-children":t.$t("sortByDate")},null,8,["checked","checked-children","un-checked-children"]),n(_,{onClick:de,disabled:!(($=e(s))!=null&&$.length)},{default:o(()=>[p(a(t.$t("tiktokView")),1)]),_:1},8,["disabled"]),n(_,{onClick:e(Z)},{default:o(()=>[p(a(t.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick"]),n(_,{onClick:e(j)},{default:o(()=>[p(a(t.$t("saveAllAsJson")),1)]),_:1},8,["onClick"])]),(D=e(s))!=null&&D.length?(u(),U(e(ze),{key:0,ref_key:"scroller",ref:v,class:"file-list",items:e(s),"item-size":e(A).first,"key-field":"fullpath","item-secondary-size":e(A).second,gridItems:e(K),onScroll:e(I)},{after:o(()=>[Ee]),default:o(({item:i,index:R})=>[n(Be,{idx:R,file:i,"cell-width":e(Y),"show-menu-idx":e(w),"onUpdate:showMenuIdx":l[4]||(l[4]=z=>G(w)?w.value=z:null),onDragstart:e(Q),onDragend:e(X),onFileItemClick:e(q),onTiktokView:(z,fe)=>e(P)(e(s),fe),"full-screen-preview-image-url":e(s)[e(r)]?e(Ie)(e(s)[e(r)]):"",selected:e(h).includes(R),onContextMenuClick:e(y),onPreviewVisibleChange:e(W),"is-selected-mutil-files":e(h).length>1,"enable-change-indicator":e(ee),"seed-change-checked":e(te),"get-gen-diff":e(le),"get-gen-diff-watch-dep":e(ne)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","onTiktokView","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):e(g).load&&t.selectedTagIds.and_tags.length===1&&!((F=t.selectedTagIds.folder_paths_str)!=null&&F.trim())?(u(),S("div",Je,[d("div",We,[d("p",Ke,a(t.$t("tagSearchNoResultsMessage")),1),n(me,{onClick:l[5]||(l[5]=i=>e(_e)()),type:"primary"},{default:o(()=>[p(a(t.$t("rebuildImageIndex")),1)]),_:1})])])):b("",!0),e(x)?(u(),S("div",Oe,[n(e(Ve),{onClick:l[6]||(l[6]=i=>e(M)("prev")),class:L({disable:!e(T)("prev")})},null,8,["class"]),n(e($e),{onClick:l[7]||(l[7]=i=>e(M)("next")),class:L({disable:!e(T)("next")})},null,8,["class"])])):b("",!0)]}),_:1},8,["spinning"]),e(x)&&e(s)&&e(s)[e(r)]?(u(),U(De,{key:0,file:e(s)[e(r)],idx:e(r),onContextMenuClick:e(y)},null,8,["file","idx","onContextMenuClick"])):b("",!0)],512)}}});const at=Me(qe,[["__scopeId","data-v-4815fec6"]]);export{at as default};
